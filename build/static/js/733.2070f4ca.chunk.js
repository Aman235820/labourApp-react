"use strict";(self.webpackChunklabour_app_react=self.webpackChunklabour_app_react||[]).push([[733],{4733:(e,a,s)=>{s.r(a),s.d(a,{default:()=>A});var t=s(9379),r=s(45),c=s(5043),o=s(3519),n=s(1072),l=s(8602),i=s(8628),d=s(1719),u=s(3722),m=s(7994),b=s(4282),h=s(7417),x=s(3204),f=s(9539),g=s(3216),y=s(579);const N=["reviews"];const A=function(){const[e,a]=(0,c.useState)(""),[s,A]=(0,c.useState)(""),[p,v]=(0,c.useState)(""),[w,j]=(0,c.useState)(!1),[P,L]=(0,c.useState)(null),[R,S]=(0,c.useState)(!1),[T,k]=(0,c.useState)(!1),C=(0,g.Zp)();return(0,c.useEffect)((()=>{if(P){const e=setTimeout((()=>L(null)),2e3);return()=>clearTimeout(e)}}),[P]),(0,c.useEffect)((()=>{if(p&&p.toLowerCase().includes("success")){const e=setTimeout((()=>v("")),2e3);return()=>clearTimeout(e)}}),[p]),(0,y.jsx)(o.A,{className:"py-5",children:(0,y.jsx)(n.A,{className:"justify-content-center",children:(0,y.jsx)(l.A,{md:6,lg:5,children:(0,y.jsx)(i.A,{className:"shadow-sm login-card",children:(0,y.jsxs)(i.A.Body,{className:"p-4",children:[(0,y.jsxs)("div",{className:"text-center mb-4",children:[(0,y.jsx)("h2",{className:"display-6 mb-3",children:"Labour Login"}),(0,y.jsx)("p",{className:"text-muted",children:"Enter your mobile number to access your account"})]}),P&&(0,y.jsxs)(d.A,{variant:"danger",className:"mb-4 d-flex align-items-center",children:[(0,y.jsx)(x.TNq,{className:"me-2"}),P]}),(0,y.jsxs)(u.A,{onSubmit:async a=>{if(a.preventDefault(),e.trim())if(s.trim())try{S(!0),L(null);const a=await f.n.loginLabour(e,s);if(a&&a.token&&a.returnValue){const e=a.returnValue,{reviews:s}=e,c=(0,r.A)(e,N);localStorage.setItem("labour",JSON.stringify((0,t.A)((0,t.A)({},c),{},{token:a.token}))),C("/labourDashboard")}else L("Invalid mobile number or OTP")}catch(c){L("Error during login"),console.error("Login error:",c)}finally{S(!1)}else L("Please enter the OTP");else L("Please enter your mobile number")},children:[(0,y.jsxs)(u.A.Group,{className:"mb-4",children:[(0,y.jsxs)(u.A.Label,{className:"text-muted",children:[(0,y.jsx)(x.Cab,{className:"me-2"}),"Mobile Number"]}),(0,y.jsxs)(m.A,{children:[(0,y.jsx)(u.A.Control,{type:"tel",placeholder:"Enter your mobile number",value:e,onChange:e=>a(e.target.value.replace(/\D/g,"").slice(0,10)),className:"py-2",pattern:"[0-9]{10}",maxLength:"10",required:!0}),(0,y.jsx)(b.A,{variant:"outline-primary",type:"button",onClick:async()=>{if(v(""),j(!0),!e||!/^[0-9]{10}$/.test(e))return v("Please enter a valid 10-digit mobile number before requesting OTP."),void j(!1);try{await f.n.requestOTP(e,"LABOUR"),v("OTP sent successfully!")}catch(a){v(a.message||"Failed to send OTP.")}finally{j(!1)}},disabled:w,children:w?"Sending OTP...":"Request OTP"})]}),p&&(0,y.jsx)(u.A.Text,{className:p.includes("success")?"text-success":"text-danger",children:p})]}),(0,y.jsxs)(u.A.Group,{className:"mb-4",children:[(0,y.jsxs)(u.A.Label,{className:"text-muted",children:[(0,y.jsx)(x.pXu,{className:"me-2"}),"OTP"]}),(0,y.jsxs)(m.A,{children:[(0,y.jsx)(u.A.Control,{type:T?"text":"password",placeholder:"Enter OTP",value:s,onChange:e=>A(e.target.value.replace(/\D/g,"").slice(0,6)),className:"py-2",maxLength:"6",required:!0}),(0,y.jsx)(b.A,{variant:"outline-secondary",type:"button",onClick:()=>k((e=>!e)),tabIndex:-1,children:T?(0,y.jsx)(x.mx3,{}):(0,y.jsx)(x.Ny1,{})})]})]}),(0,y.jsx)(b.A,{variant:"primary",type:"submit",className:"w-100 py-2 d-flex align-items-center justify-content-center",disabled:R,children:R?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(h.A,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Logging in..."]}):(0,y.jsxs)(y.Fragment,{children:["Login ",(0,y.jsx)(x.Z0P,{className:"ms-2"})]})})]}),(0,y.jsx)("div",{className:"text-center mt-4",children:(0,y.jsxs)("p",{className:"mb-0",children:["Don't have an account?"," ",(0,y.jsx)(b.A,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>C("/labourRegister"),children:"Register here"})]})})]})})})})})}},8628:(e,a,s)=>{s.d(a,{A:()=>z});var t=s(9379),r=s(45),c=s(8139),o=s.n(c),n=s(5043),l=s(7852),i=s(579);const d=["className","bsPrefix","as"],u=n.forwardRef(((e,a)=>{let{className:s,bsPrefix:c,as:n="div"}=e,u=(0,r.A)(e,d);return c=(0,l.oU)(c,"card-body"),(0,i.jsx)(n,(0,t.A)({ref:a,className:o()(s,c)},u))}));u.displayName="CardBody";const m=u,b=["className","bsPrefix","as"],h=n.forwardRef(((e,a)=>{let{className:s,bsPrefix:c,as:n="div"}=e,d=(0,r.A)(e,b);return c=(0,l.oU)(c,"card-footer"),(0,i.jsx)(n,(0,t.A)({ref:a,className:o()(s,c)},d))}));h.displayName="CardFooter";const x=h;var f=s(1778);const g=["bsPrefix","className","as"],y=n.forwardRef(((e,a)=>{let{bsPrefix:s,className:c,as:d="div"}=e,u=(0,r.A)(e,g);const m=(0,l.oU)(s,"card-header"),b=(0,n.useMemo)((()=>({cardHeaderBsPrefix:m})),[m]);return(0,i.jsx)(f.A.Provider,{value:b,children:(0,i.jsx)(d,(0,t.A)((0,t.A)({ref:a},u),{},{className:o()(c,m)}))})}));y.displayName="CardHeader";const N=y,A=["bsPrefix","className","variant","as"],p=n.forwardRef(((e,a)=>{let{bsPrefix:s,className:c,variant:n,as:d="img"}=e,u=(0,r.A)(e,A);const m=(0,l.oU)(s,"card-img");return(0,i.jsx)(d,(0,t.A)({ref:a,className:o()(n?"".concat(m,"-").concat(n):m,c)},u))}));p.displayName="CardImg";const v=p,w=["className","bsPrefix","as"],j=n.forwardRef(((e,a)=>{let{className:s,bsPrefix:c,as:n="div"}=e,d=(0,r.A)(e,w);return c=(0,l.oU)(c,"card-img-overlay"),(0,i.jsx)(n,(0,t.A)({ref:a,className:o()(s,c)},d))}));j.displayName="CardImgOverlay";const P=j,L=["className","bsPrefix","as"],R=n.forwardRef(((e,a)=>{let{className:s,bsPrefix:c,as:n="a"}=e,d=(0,r.A)(e,L);return c=(0,l.oU)(c,"card-link"),(0,i.jsx)(n,(0,t.A)({ref:a,className:o()(s,c)},d))}));R.displayName="CardLink";const S=R;var T=s(4488);const k=["className","bsPrefix","as"],C=(0,T.A)("h6"),O=n.forwardRef(((e,a)=>{let{className:s,bsPrefix:c,as:n=C}=e,d=(0,r.A)(e,k);return c=(0,l.oU)(c,"card-subtitle"),(0,i.jsx)(n,(0,t.A)({ref:a,className:o()(s,c)},d))}));O.displayName="CardSubtitle";const I=O,q=["className","bsPrefix","as"],B=n.forwardRef(((e,a)=>{let{className:s,bsPrefix:c,as:n="p"}=e,d=(0,r.A)(e,q);return c=(0,l.oU)(c,"card-text"),(0,i.jsx)(n,(0,t.A)({ref:a,className:o()(s,c)},d))}));B.displayName="CardText";const U=B,E=["className","bsPrefix","as"],D=(0,T.A)("h5"),F=n.forwardRef(((e,a)=>{let{className:s,bsPrefix:c,as:n=D}=e,d=(0,r.A)(e,E);return c=(0,l.oU)(c,"card-title"),(0,i.jsx)(n,(0,t.A)({ref:a,className:o()(s,c)},d))}));F.displayName="CardTitle";const M=F,V=["bsPrefix","className","bg","text","border","body","children","as"],_=n.forwardRef(((e,a)=>{let{bsPrefix:s,className:c,bg:n,text:d,border:u,body:b=!1,children:h,as:x="div"}=e,f=(0,r.A)(e,V);const g=(0,l.oU)(s,"card");return(0,i.jsx)(x,(0,t.A)((0,t.A)({ref:a},f),{},{className:o()(c,g,n&&"bg-".concat(n),d&&"text-".concat(d),u&&"border-".concat(u)),children:b?(0,i.jsx)(m,{children:h}):h}))}));_.displayName="Card";const z=Object.assign(_,{Img:v,Title:M,Subtitle:I,Body:m,Link:S,Text:U,Header:N,Footer:x,ImgOverlay:P})},9539:(e,a,s)=>{s.d(a,{n:()=>c});var t=s(9722);const r="".concat("http://localhost:4000","/labourapp"),c={getRequestedServices:async e=>{try{const a="".concat(r,"/labour/showRequestedServices/").concat(e);return(await t.A.get(a)).data}catch(a){throw a}},getReviews:async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"reviewTime",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"desc";try{const c="".concat(r,"/labour/showMyReviews/").concat(e,"?sortBy=").concat(a,"&sortOrder=").concat(s),o=localStorage.getItem("user"),n=localStorage.getItem("token")||localStorage.getItem("authToken"),l={};if(n)l.Authorization="Bearer ".concat(n);else if(o){const e=JSON.parse(o);e.token&&(l.Authorization="Bearer ".concat(e.token))}const i=await t.A.get(c,{headers:l});if(i.data.hasError)throw new Error(i.data.message||"Failed to fetch reviews");return i.data.returnValue||[]}catch(c){return console.error("Reviews API error:",c.message),[]}},getOverallRatings:async e=>{try{const a="".concat(r,"/labour/showMyRatings/").concat(e);return(await t.A.get(a)).data}catch(a){throw a}},updateBookingStatus:async(e,a,s)=>{try{const c="".concat(r,"/labour/setBookingStatus?labourId=").concat(e,"&bookingId=").concat(a,"&bookingStatusCode=").concat(s);return(await t.A.get(c)).data}catch(c){throw c}},showRequestedServices:async e=>{try{const a="".concat(r,"/labour/showRequestedServices/").concat(e);return(await t.A.get(a)).data}catch(a){throw a}},getLabourById:async e=>{try{const a="".concat(r,"/labourReq/getLabourById/").concat(e),s=await t.A.get(a);if(s.data.hasError)throw new Error(s.data.message||"Failed to fetch labour details");return s.data.returnValue}catch(a){throw a}},registerLabour:async(e,a)=>{try{const s="".concat(r,"/auth/registerLabour?otp=").concat(a);return(await t.A.post(s,e)).data}catch(c){var s;throw(null===(s=c.response)||void 0===s?void 0:s.data)||c.message}},loginLabour:async(e,a)=>{try{const s="".concat(r,"/auth/labourLogin?mobileNumber=").concat(e,"&otp=").concat(a);return(await t.A.get(s)).data}catch(c){var s;throw(null===(s=c.response)||void 0===s?void 0:s.data)||c.message}},requestOTP:async(e,a)=>{try{const s="".concat(r,"/auth/requestOTP");return(await t.A.post(s,{mobile:e,role:a})).data}catch(c){var s;throw(null===(s=c.response)||void 0===s?void 0:s.data)||c.message}},deleteLabour:async e=>{try{const a="".concat(r,"/admin/removeLabour/").concat(e);return(await t.A.delete(a)).data}catch(s){var a;throw(null===(a=s.response)||void 0===a?void 0:a.data)||s.message}},updateLabourDetails:async e=>{try{const a="".concat(r,"/labour/updateLabourDetails");return(await t.A.patch(a,e)).data}catch(s){var a;throw(null===(a=s.response)||void 0===a?void 0:a.data)||s.message}}}}}]);
//# sourceMappingURL=733.2070f4ca.chunk.js.map