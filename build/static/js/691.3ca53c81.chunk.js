"use strict";(self.webpackChunklabour_app_react=self.webpackChunklabour_app_react||[]).push([[691],{3691:(e,a,t)=>{t.r(a),t.d(a,{default:()=>A});var s=t(45),l=t(9379),r=t(5043),o=t(3519),n=t(1072),c=t(8602),i=t(8628),u=t(3722),d=t(7994),m=t(4282),b=t(7417),h=t(3216),g=t(9539),x=t(3204),v=t(5035),N=t(579);const p=["reviews"];const A=function(){const e=(0,h.Zp)(),[a,t]=(0,r.useState)({labourName:"",labourSkill:"",labourSubSkill:[],labourMobileNo:""}),[A,f]=(0,r.useState)(""),[j,y]=(0,r.useState)(""),[S,w]=(0,r.useState)(!1),[k,L]=(0,r.useState)(""),[T,C]=(0,r.useState)(""),[P,q]=(0,r.useState)(!1),[O,R]=(0,r.useState)([]),[E,I]=(0,r.useState)(null),[M,B]=(0,r.useState)(!1);(0,r.useEffect)((()=>{fetch("/services.json").then((e=>e.json())).then((e=>R(e.services))).catch((e=>console.error("Error loading services:",e)))}),[]),(0,r.useEffect)((()=>{if(k){const e=setTimeout((()=>L("")),2e3);return()=>clearTimeout(e)}}),[k]),(0,r.useEffect)((()=>{if(T){const e=setTimeout((()=>C("")),2e3);return()=>clearTimeout(e)}}),[T]),(0,r.useEffect)((()=>{if(j&&j.toLowerCase().includes("success")){const e=setTimeout((()=>y("")),2e3);return()=>clearTimeout(e)}}),[j]);const D=e=>{const{name:a,value:s}=e.target;if(t((e=>(0,l.A)((0,l.A)({},e),{},{[a]:s}))),"labourSkill"===a){const e=O.find((e=>e.name===s));I(e),t((e=>(0,l.A)((0,l.A)({},e),{},{labourSubSkill:[]})))}};return(0,N.jsx)(o.A,{className:"mt-5 mb-5",children:(0,N.jsx)(n.A,{className:"justify-content-center",children:(0,N.jsx)(c.A,{md:8,lg:6,children:(0,N.jsx)(i.A,{className:"shadow-lg border-0",children:(0,N.jsxs)(i.A.Body,{className:"p-5",children:[(0,N.jsxs)("div",{className:"text-center mb-4",children:[(0,N.jsx)("h2",{className:"fw-bold text-primary",children:"Labour Registration"}),(0,N.jsx)("p",{className:"text-muted",children:"Join InstaLab as a skilled professional"})]}),k&&(0,N.jsxs)("div",{className:"alert alert-danger d-flex align-items-center",role:"alert",children:[(0,N.jsx)(x.TNq,{className:"me-2"}),k]}),T&&(0,N.jsxs)("div",{className:"alert alert-success d-flex align-items-center",role:"alert",children:[(0,N.jsx)(x.A7C,{className:"me-2"}),T]}),(0,N.jsxs)(u.A,{onSubmit:async t=>{if(t.preventDefault(),L(""),C(""),q(!0),E&&0===a.labourSubSkill.length)return L("Please select at least one sub skill."),void q(!1);try{const t={labourName:a.labourName,labourSkill:a.labourSkill,labourSubSkills:a.labourSubSkill.map((e=>({subSkillName:e}))),labourMobileNo:a.labourMobileNo},r=await g.n.registerLabour(t,A);if(r.token&&r.returnValue){const a=r.returnValue,{reviews:t}=a,o=(0,s.A)(a,p);localStorage.setItem("labour",JSON.stringify((0,l.A)((0,l.A)({},o),{},{token:r.token}))),e("/labourDashboard")}else L("Registration failed. Please try again.")}catch(k){L("Registration failed. Please try again.")}finally{q(!1)}},children:[(0,N.jsxs)(u.A.Group,{className:"mb-4",children:[(0,N.jsxs)("div",{className:"d-flex align-items-center",children:[(0,N.jsx)(x.x$1,{className:"me-2"}),(0,N.jsx)(u.A.Label,{className:"fw-bold mb-0",children:"Full Name"})]}),(0,N.jsx)(u.A.Control,{type:"text",name:"labourName",value:a.labourName,onChange:D,required:!0,className:"form-control-lg",placeholder:"Enter your full name"})]}),(0,N.jsxs)(u.A.Group,{className:"mb-4",children:[(0,N.jsxs)("div",{className:"d-flex align-items-center",children:[(0,N.jsx)(x.xdT,{className:"me-2"}),(0,N.jsx)(u.A.Label,{className:"fw-bold mb-0",children:"Main Skill"})]}),(0,N.jsxs)(u.A.Select,{name:"labourSkill",value:a.labourSkill,onChange:D,required:!0,className:"form-control-lg",children:[(0,N.jsx)("option",{value:"",children:"Select your main skill"}),O.map(((e,a)=>(0,N.jsx)("option",{value:e.name,children:e.name},a)))]})]}),E&&(0,N.jsxs)(u.A.Group,{className:"mb-4",children:[(0,N.jsxs)("div",{className:"d-flex align-items-center",children:[(0,N.jsx)(x.xdT,{className:"me-2"}),(0,N.jsx)(u.A.Label,{className:"fw-bold mb-0",children:"Sub Skill"})]}),(0,N.jsx)(v.Ay,{name:"labourSubSkill",isMulti:!0,options:[{value:"all",label:"Select All"},...E.subCategories.map((e=>({value:e,label:e})))],onChange:e=>{e&&e.some((e=>"all"===e.value))?t((e=>(0,l.A)((0,l.A)({},e),{},{labourSubSkill:E.subCategories}))):t((a=>(0,l.A)((0,l.A)({},a),{},{labourSubSkill:e?e.map((e=>e.value)):[]})))},value:a.labourSubSkill.map((e=>({value:e,label:e}))),className:"basic-multi-select",classNamePrefix:"select",placeholder:"Select your sub skills",menuPortalTarget:document.body,styles:{menuPortal:e=>(0,l.A)((0,l.A)({},e),{},{zIndex:9999})}})]}),(0,N.jsxs)(u.A.Group,{className:"mb-4",children:[(0,N.jsxs)("div",{className:"d-flex align-items-center",children:[(0,N.jsx)(x.Cab,{className:"me-2"}),(0,N.jsx)(u.A.Label,{className:"fw-bold mb-0",children:"Mobile Number"})]}),(0,N.jsxs)(d.A,{children:[(0,N.jsx)(u.A.Control,{type:"tel",name:"labourMobileNo",value:a.labourMobileNo,onChange:e=>{const s=e.target.value.replace(/\D/g,"").slice(0,10);t((0,l.A)((0,l.A)({},a),{},{labourMobileNo:s}))},required:!0,pattern:"[0-9]{10}",className:"form-control-lg",placeholder:"Enter 10-digit mobile number",maxLength:"10"}),(0,N.jsx)(m.A,{variant:"outline-primary",type:"button",onClick:async()=>{y(""),w(!0);const e=a.labourMobileNo;if(!e||!/^[0-9]{10}$/.test(e))return y("Please enter a valid 10-digit mobile number before requesting OTP."),void w(!1);try{await g.n.requestOTP(e,"LABOUR"),y("OTP sent successfully!")}catch(t){y(t.message||"Failed to send OTP.")}finally{w(!1)}},disabled:S,children:S?"Sending OTP...":"Request OTP"})]}),j&&(0,N.jsx)(u.A.Text,{className:j.includes("success")?"text-success":"text-danger",children:j})]}),(0,N.jsxs)(u.A.Group,{className:"mb-4",children:[(0,N.jsxs)("div",{className:"d-flex align-items-center",children:[(0,N.jsx)(x.pXu,{className:"me-2"}),(0,N.jsx)(u.A.Label,{className:"fw-bold mb-0",children:"OTP"})]}),(0,N.jsxs)(d.A,{children:[(0,N.jsx)(u.A.Control,{type:M?"text":"password",placeholder:"Enter OTP",value:A,onChange:e=>f(e.target.value.replace(/\D/g,"").slice(0,6)),className:"form-control-lg",maxLength:"6",required:!0}),(0,N.jsx)(m.A,{variant:"outline-secondary",type:"button",onClick:()=>B((e=>!e)),tabIndex:-1,children:M?(0,N.jsx)(x.mx3,{}):(0,N.jsx)(x.Ny1,{})})]})]}),(0,N.jsx)("div",{className:"d-grid gap-2",children:(0,N.jsx)(m.A,{variant:"primary",type:"submit",className:"btn-lg fw-bold d-flex align-items-center justify-content-center",disabled:P,children:P?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(b.A,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Creating Account..."]}):(0,N.jsxs)(N.Fragment,{children:["Create Account ",(0,N.jsx)(x.Z0P,{className:"ms-2"})]})})}),(0,N.jsx)("div",{className:"text-center mt-4",children:(0,N.jsxs)("p",{className:"mb-0",children:["Already have an account?"," ",(0,N.jsx)(m.A,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>e("/labourLogin"),children:"Login here"})]})})]})]})})})})})}},9539:(e,a,t)=>{t.d(a,{n:()=>r});var s=t(9722);const l="".concat("http://localhost:4000","/labourapp"),r={getRequestedServices:async e=>{try{const a="".concat(l,"/labour/showRequestedServices/").concat(e);return(await s.A.get(a)).data}catch(a){throw a}},getReviews:async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"reviewTime",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"desc";try{const r="".concat(l,"/labour/showMyReviews/").concat(e,"?sortBy=").concat(a,"&sortOrder=").concat(t),o=localStorage.getItem("user"),n=localStorage.getItem("token")||localStorage.getItem("authToken"),c={};if(n)c.Authorization="Bearer ".concat(n);else if(o){const e=JSON.parse(o);e.token&&(c.Authorization="Bearer ".concat(e.token))}const i=await s.A.get(r,{headers:c});if(i.data.hasError)throw new Error(i.data.message||"Failed to fetch reviews");return i.data.returnValue||[]}catch(r){return console.error("Reviews API error:",r.message),[]}},getOverallRatings:async e=>{try{const a="".concat(l,"/labour/showMyRatings/").concat(e);return(await s.A.get(a)).data}catch(a){throw a}},updateBookingStatus:async(e,a,t)=>{try{const r="".concat(l,"/labour/setBookingStatus?labourId=").concat(e,"&bookingId=").concat(a,"&bookingStatusCode=").concat(t);return(await s.A.get(r)).data}catch(r){throw r}},showRequestedServices:async e=>{try{const a="".concat(l,"/labour/showRequestedServices/").concat(e);return(await s.A.get(a)).data}catch(a){throw a}},getLabourById:async e=>{try{const a="".concat(l,"/labourReq/getLabourById/").concat(e),t=await s.A.get(a);if(t.data.hasError)throw new Error(t.data.message||"Failed to fetch labour details");return t.data.returnValue}catch(a){throw a}},registerLabour:async(e,a)=>{try{const t="".concat(l,"/auth/registerLabour?otp=").concat(a);return(await s.A.post(t,e)).data}catch(r){var t;throw(null===(t=r.response)||void 0===t?void 0:t.data)||r.message}},loginLabour:async(e,a)=>{try{const t="".concat(l,"/auth/labourLogin?mobileNumber=").concat(e,"&otp=").concat(a);return(await s.A.get(t)).data}catch(r){var t;throw(null===(t=r.response)||void 0===t?void 0:t.data)||r.message}},requestOTP:async(e,a)=>{try{const t="".concat(l,"/auth/requestOTP");return(await s.A.post(t,{mobile:e,role:a})).data}catch(r){var t;throw(null===(t=r.response)||void 0===t?void 0:t.data)||r.message}},deleteLabour:async e=>{try{const a="".concat(l,"/admin/removeLabour/").concat(e);return(await s.A.delete(a)).data}catch(t){var a;throw(null===(a=t.response)||void 0===a?void 0:a.data)||t.message}},updateLabourDetails:async e=>{try{const a="".concat(l,"/labour/updateLabourDetails");return(await s.A.patch(a,e)).data}catch(t){var a;throw(null===(a=t.response)||void 0===a?void 0:a.data)||t.message}}}}}]);
//# sourceMappingURL=691.3ca53c81.chunk.js.map