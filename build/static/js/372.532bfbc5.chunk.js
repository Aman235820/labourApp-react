"use strict";(self.webpackChunklabour_app_react=self.webpackChunklabour_app_react||[]).push([[372],{3372:(e,a,s)=>{s.r(a),s.d(a,{default:()=>A});var t=s(9379),l=s(45),r=s(5043),n=s(3519),i=s(1072),c=s(8602),o=s(8628),m=s(3722),d=s(7994),u=s(4282),p=s(7417),h=s(4858),x=s(3387),b=s(3216),g=s(3204),j=s(579);const N=["otp"],A=()=>{const{register:e,handleSubmit:a,formState:{errors:s},getValues:A}=(0,h.mN)(),f=(0,b.Zp)(),[v,y]=(0,r.useState)(!1),[w,T]=(0,r.useState)(""),[C,P]=(0,r.useState)(""),[k,q]=(0,r.useState)(!1),[L,S]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(w){const e=setTimeout((()=>T("")),2e3);return()=>clearTimeout(e)}}),[w]),(0,r.useEffect)((()=>{if(C&&C.toLowerCase().includes("success")){const e=setTimeout((()=>P("")),2e3);return()=>clearTimeout(e)}}),[C]);return(0,j.jsx)(n.A,{className:"mt-5 mb-5",children:(0,j.jsx)(i.A,{className:"justify-content-center",children:(0,j.jsx)(c.A,{md:8,lg:6,children:(0,j.jsx)(o.A,{className:"shadow-lg border-0",children:(0,j.jsxs)(o.A.Body,{className:"p-5",children:[(0,j.jsxs)("div",{className:"text-center mb-4",children:[(0,j.jsx)("h2",{className:"fw-bold text-primary",children:"Create Account"}),(0,j.jsx)("p",{className:"text-muted",children:"Join InstaLab and connect with skilled professionals"})]}),w&&(0,j.jsxs)("div",{className:"alert alert-danger d-flex align-items-center",role:"alert",children:[(0,j.jsx)(g.TNq,{className:"me-2"}),w]}),(0,j.jsxs)(m.A,{onSubmit:a((async e=>{try{y(!0),T("");const{otp:a}=e,s=(0,l.A)(e,N),r=await(0,x.DY)(s,a);r.token&&r.returnValue?(localStorage.setItem("user",JSON.stringify((0,t.A)((0,t.A)({},r.returnValue),{},{token:r.token}))),f("/userHome")):T("Registration failed. Please try again.")}catch(w){console.error("Registration failed:",w),T(w.message||"Registration failed. Please try again.")}finally{y(!1)}})),children:[(0,j.jsxs)(m.A.Group,{className:"mb-4",children:[(0,j.jsxs)("div",{className:"d-flex align-items-center",children:[(0,j.jsx)(g.x$1,{className:"me-2"}),(0,j.jsx)(m.A.Label,{className:"fw-bold mb-0",children:"Full Name"})]}),(0,j.jsx)(m.A.Control,(0,t.A)({type:"text",placeholder:"Enter your full name",className:"form-control-lg ".concat(s.fullName?"is-invalid":"")},e("fullName",{required:"Full name is required",minLength:{value:3,message:"Name must be at least 3 characters"}}))),s.fullName&&(0,j.jsx)(m.A.Text,{className:"text-danger",children:s.fullName.message})]}),(0,j.jsxs)(m.A.Group,{className:"mb-4",children:[(0,j.jsxs)("div",{className:"d-flex align-items-center",children:[(0,j.jsx)(g.maD,{className:"me-2"}),(0,j.jsx)(m.A.Label,{className:"fw-bold mb-0",children:"Email Address"})]}),(0,j.jsx)(m.A.Control,(0,t.A)({type:"email",placeholder:"Enter your email",className:"form-control-lg ".concat(s.email?"is-invalid":"")},e("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Please enter a valid email address"}}))),s.email&&(0,j.jsx)(m.A.Text,{className:"text-danger",children:s.email.message})]}),(0,j.jsxs)(m.A.Group,{className:"mb-4",children:[(0,j.jsxs)("div",{className:"d-flex align-items-center",children:[(0,j.jsx)(g.Cab,{className:"me-2"}),(0,j.jsx)(m.A.Label,{className:"fw-bold mb-0",children:"Mobile Number"})]}),(0,j.jsxs)(d.A,{children:[(0,j.jsx)(m.A.Control,(0,t.A)((0,t.A)({type:"tel",placeholder:"Enter your mobile number",className:"form-control-lg ".concat(s.mobileNumber?"is-invalid":"")},e("mobileNumber",{required:"Mobile number is required",pattern:{value:/^[0-9]{10}$/,message:"Please enter a valid 10-digit mobile number"},onChange:e=>{const a=e.target.value.replace(/\D/g,"").slice(0,10);e.target.value=a}})),{},{maxLength:"10"})),(0,j.jsx)(u.A,{variant:"outline-primary",type:"button",onClick:async()=>{P(""),q(!0);const e=A("mobileNumber");if(!e||!/^[0-9]{10}$/.test(e))return P("Please enter a valid 10-digit mobile number before requesting OTP."),void q(!1);try{await(0,x.DU)(e,"USER"),P("OTP sent successfully!")}catch(a){P(a.message||"Failed to send OTP.")}finally{q(!1)}},disabled:k,children:k?"Sending OTP...":"Request OTP"})]}),s.mobileNumber&&(0,j.jsx)(m.A.Text,{className:"text-danger",children:s.mobileNumber.message}),C&&(0,j.jsx)(m.A.Text,{className:C.includes("success")?"text-success":"text-danger",children:C})]}),(0,j.jsxs)(m.A.Group,{className:"mb-4",children:[(0,j.jsxs)("div",{className:"d-flex align-items-center",children:[(0,j.jsx)(g.pXu,{className:"me-2"}),(0,j.jsx)(m.A.Label,{className:"fw-bold mb-0",children:"OTP"})]}),(0,j.jsxs)(d.A,{children:[(0,j.jsx)(m.A.Control,(0,t.A)((0,t.A)({type:L?"text":"password",placeholder:"Enter OTP",className:"form-control-lg ".concat(s.otp?"is-invalid":"")},e("otp",{required:"OTP is required",pattern:{value:/^[0-9]{4,6}$/,message:"Please enter a valid 4 to 6-digit OTP"}})),{},{maxLength:"6"})),(0,j.jsx)(u.A,{variant:"outline-secondary",type:"button",onClick:()=>S((e=>!e)),tabIndex:-1,children:L?(0,j.jsx)(g.mx3,{}):(0,j.jsx)(g.Ny1,{})})]}),s.otp&&(0,j.jsx)(m.A.Text,{className:"text-danger",children:s.otp.message})]}),(0,j.jsx)("div",{className:"d-grid gap-2",children:(0,j.jsx)(u.A,{variant:"primary",type:"submit",className:"btn-lg fw-bold d-flex align-items-center justify-content-center",disabled:v,children:v?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(p.A,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Creating Account..."]}):(0,j.jsxs)(j.Fragment,{children:["Create Account ",(0,j.jsx)(g.Z0P,{className:"ms-2"})]})})}),(0,j.jsx)("div",{className:"text-center mt-4",children:(0,j.jsxs)("p",{className:"mb-0",children:["Already have an account?"," ",(0,j.jsx)(u.A,{variant:"link",className:"p-0 text-decoration-none",onClick:()=>f("/login"),children:"Login here"})]})})]})]})})})})})}},3387:(e,a,s)=>{s.d(a,{DU:()=>i,DY:()=>r,Lx:()=>n,hG:()=>c});var t=s(9722);const l="".concat("http://localhost:4000","/labourapp"),r=async(e,a)=>{try{const s="".concat(l,"/auth/registerUser?otp=").concat(a);return(await t.A.post(s,e,{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0})).data}catch(r){var s;throw(null===(s=r.response)||void 0===s?void 0:s.data)||r.message}},n=async e=>{let{mobileNumber:a,otp:s}=e;try{const e="".concat(l,"/auth/userLogin?otp=").concat(s);return(await t.A.post(e,{mobileNumber:a},{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0})).data}catch(n){var r;throw(null===(r=n.response)||void 0===r?void 0:r.data)||n.message}},i=async(e,a)=>{try{const s="".concat(l,"/auth/requestOTP");return(await t.A.post(s,{mobile:e,role:a},{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0})).data}catch(r){var s;throw(null===(s=r.response)||void 0===s?void 0:s.data)||r.message}},c=async e=>{try{const a="".concat(l,"/admin/removeUser/").concat(e);return(await t.A.delete(a,{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0})).data}catch(s){var a;throw(null===(a=s.response)||void 0===a?void 0:a.data)||s.message}}}}]);
//# sourceMappingURL=372.532bfbc5.chunk.js.map